pipeline {
    agent none

    tools {

        jdk 'myjava'
        maven "mymaven"
    }

    stages {
        stage('Compile') {
        agent any
            steps {
              
                sh 'mvn compile'

               
            }

            
            }
        
    
        stage('Codereview') {
        agent label{'linux_slave'}
            steps {
              
                sh 'mvn pmd:pmd'

            }

            
            }
         
        stage('UnitTest') {
        agent any
            steps {
               
                sh 'mvn test'

            }

            
            }
        
        stage('MetricCheck') {
        agent none
            steps {
               
               
                sh 'mvn cobertura:cobertura -Dcobertura.report.format=xml'

              
            }

            
            }
        
        stage('Package') {
        agent label{'linux_slave'}
            steps {
              

               
                sh 'mvn package'

               
            }

            
            }
    }
}
